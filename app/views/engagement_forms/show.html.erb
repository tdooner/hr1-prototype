<div class="grid-row">
  <div class="grid-col-12">
    <h1 class="usa-prose">Community Engagement Form Submitted</h1>
    
    <div class="usa-alert usa-alert--success" role="alert">
      <div class="usa-alert__body">
        <h3 class="usa-alert__heading">Success!</h3>
        <p class="usa-alert__text">Your community engagement form has been submitted successfully.</p>
      </div>
    </div>
    
    <div class="usa-summary-box">
      <div class="usa-summary-box__body">
        <h3 class="usa-summary-box__heading">Form Summary</h3>
        <div class="usa-summary-box__text">
          <p><strong>Name:</strong> <%= @engagement_form.user_name %></p>
          <p><strong>Email:</strong> <%= @engagement_form.email %></p>
  
          
          <h4 class="usa-summary-box__heading">Engagement Types:</h4>
          <ul>
            <% if @engagement_form.has_job? %>
              <li>✅ Has a job</li>
            <% end %>
            <% if @engagement_form.is_student? %>
              <li>✅ Is a student</li>
            <% end %>
            <% if @engagement_form.enrolled_work_program? %>
              <li>✅ Enrolled in work program</li>
            <% end %>
            <% if @engagement_form.volunteers_nonprofit? %>
              <li>✅ Volunteers with nonprofit</li>
            <% end %>
          </ul>
        </div>
      </div>
    </div>
    
    <% if @engagement_form.has_job? %>
      <div class="usa-summary-box">
        <div class="usa-summary-box__body">
          <h3 class="usa-summary-box__heading">Employment Details</h3>
          <div class="usa-summary-box__text">
            <% if @engagement_form.job_paychecks.any? %>
              <div class="usa-table-container--scrollable" tabindex="0">
                <table class="usa-table">
                  <thead>
                    <tr>
                      <th scope="col">Pay Date</th>
                      <th scope="col">Gross Pay</th>
                      <th scope="col">Hours</th>
                    </tr>
                  </thead>
                  <tbody>
                    <% @engagement_form.job_paychecks.ordered_by_date.each do |paycheck| %>
                      <tr>
                        <td><%= paycheck.pay_date.strftime("%B %d, %Y") %></td>
                        <td>$<%= number_with_precision(paycheck.gross_pay_amount, precision: 2) %></td>
                        <td><%= paycheck.hours_worked %></td>
                      </tr>
                    <% end %>
                  </tbody>
                </table>
              </div>
              <p><strong>Total Hours:</strong> <%= @engagement_form.job_paychecks.sum(&:hours_worked) %></p>
              <p><strong>Total Gross Pay:</strong> $<%= number_with_precision(@engagement_form.job_paychecks.sum(&:gross_pay_amount), precision: 2) %></p>
            <% else %>
              <p>No paychecks have been added yet.</p>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
    
    <% if @engagement_form.student_details.present? %>
      <div class="usa-summary-box">
        <div class="usa-summary-box__body">
          <h3 class="usa-summary-box__heading">Student Details</h3>
          <div class="usa-summary-box__text">
            <p><%= @engagement_form.student_details %></p>
          </div>
        </div>
      </div>
    <% end %>
    
    <% if @engagement_form.work_program_details.present? %>
      <div class="usa-summary-box">
        <div class="usa-summary-box__body">
          <h3 class="usa-summary-box__heading">Work Program Details</h3>
          <div class="usa-summary-box__text">
            <p><%= @engagement_form.work_program_details %></p>
          </div>
        </div>
      </div>
    <% end %>
    
    <% if @engagement_form.volunteers_nonprofit? && @engagement_form.volunteer_shifts.any? %>
      <div class="usa-summary-box">
        <div class="usa-summary-box__body">
          <h3 class="usa-summary-box__heading">Volunteer Hours</h3>
          <div class="usa-summary-box__text">
            <div class="usa-table-container--scrollable" tabindex="0">
              <table class="usa-table">
                <thead>
                  <tr>
                    <th scope="col">Organization</th>
                    <th scope="col">Date</th>
                    <th scope="col">Hours</th>
                  </tr>
                </thead>
                <tbody>
                  <% @engagement_form.volunteer_shifts.ordered_by_date.each do |shift| %>
                    <tr>
                      <td><%= shift.organization_name %></td>
                      <td><%= shift.shift_date.strftime("%B %d, %Y") %></td>
                      <td><%= shift.hours %></td>
                    </tr>
                  <% end %>
                </tbody>
              </table>
            </div>
            <p><strong>Total Hours:</strong> <%= @engagement_form.volunteer_shifts.sum(&:hours) %></p>
          </div>
        </div>
      </div>
    <% end %>
    
    <div class="usa-form-group">
      <%= link_to "Download PDF", pdf_engagement_form_path(@engagement_form, format: :pdf), class: "usa-button" %>
      <%= link_to "Submit Another Form", new_engagement_form_path, class: "usa-button usa-button--outline" %>
    </div>
  </div>
</div>
