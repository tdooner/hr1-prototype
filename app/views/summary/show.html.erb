<div class="grid-row">
  <div class="grid-col-12 usa-prose">
    <h1>Community Engagement Form Summary</h1>
    
    <% if @engagement_form.completed? %>
      <div class="usa-alert usa-alert--success" role="alert">
        <div class="usa-alert__body">
          <h3 class="usa-alert__heading">Form Submitted Successfully!</h3>
          <p class="usa-alert__text">Your community engagement form has been submitted and is now complete. Below is a summary of your responses.</p>
        </div>
      </div>
    <% end %>
    
    <div class="usa-summary-box">
      <div class="usa-summary-box__body">
        <h3 class="usa-summary-box__heading">Basic Information</h3>
        <div class="usa-summary-box__text">
          <p><strong>Name:</strong> <%= @engagement_form.user_name %></p>
          <p><strong>Email:</strong> <%= @engagement_form.email %></p>
  
        </div>
      </div>
    </div>
    
    <h2 class="usa-prose">Engagement Activities</h2>
    
    <% if @engagement_form.has_job? %>
      <div class="usa-summary-box">
        <div class="usa-summary-box__body">
          <h3 class="usa-summary-box__heading">✅ Employment</h3>
          <div class="usa-summary-box__text">
            <% if @engagement_form.job_paychecks.any? %>
              <div class="usa-table-container--scrollable" tabindex="0">
                <table class="usa-table">
                  <thead>
                    <tr>
                      <th scope="col">Pay Date</th>
                      <th scope="col">Gross Pay</th>
                      <th scope="col">Hours</th>
                    </tr>
                  </thead>
                  <tbody>
                    <% @engagement_form.job_paychecks.ordered_by_date.each do |paycheck| %>
                      <tr>
                        <td><%= paycheck.pay_date.strftime("%B %d, %Y") %></td>
                        <td>$<%= number_with_precision(paycheck.gross_pay_amount, precision: 2) %></td>
                        <td><%= paycheck.hours_worked %></td>
                      </tr>
                    <% end %>
                  </tbody>
                </table>
              </div>
              <p><strong>Total Hours:</strong> <%= @engagement_form.job_paychecks.sum(&:hours_worked) %></p>
              <p><strong>Total Gross Pay:</strong> $<%= number_with_precision(@engagement_form.job_paychecks.sum(&:gross_pay_amount), precision: 2) %></p>
            <% else %>
              <p>No paychecks have been added yet.</p>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
    
    <% if @engagement_form.is_student? %>
      <div class="usa-summary-box">
        <div class="usa-summary-box__body">
          <h3 class="usa-summary-box__heading">✅ Student Status</h3>
          <div class="usa-summary-box__text">
            <% if @engagement_form.school_name.present? %>
              <p><strong>School:</strong> <%= @engagement_form.school_name %></p>
            <% end %>
            <% if @engagement_form.enrollment_status == "half_time_or_more" %>
              <p><strong>Enrollment Status:</strong> Enrolled at least half-time</p>
            <% elsif @engagement_form.enrollment_status == "less_than_half_time" %>
              <p><strong>Enrollment Status:</strong> Enrolled less than half-time</p>
              <% if @engagement_form.school_hours.present? %>
                <p><strong>School Hours per Week:</strong> <%= @engagement_form.school_hours %> hours</p>
              <% end %>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
    
    <% if @engagement_form.enrolled_work_program? %>
      <div class="usa-summary-box">
        <div class="usa-summary-box__body">
          <h3 class="usa-summary-box__heading">✅ Work Program</h3>
          <div class="usa-summary-box__text">
            <p><%= @engagement_form.work_program_details %></p>
          </div>
        </div>
      </div>
    <% end %>
    
    <% if @engagement_form.volunteers_nonprofit? %>
      <div class="usa-summary-box">
        <div class="usa-summary-box__body">
          <h3 class="usa-summary-box__heading">✅ Volunteer Work</h3>
          <div class="usa-summary-box__text">
            <% if @engagement_form.volunteer_shifts.any? %>
              <div class="usa-table-container--scrollable" tabindex="0">
                <table class="usa-table">
                  <thead>
                    <tr>
                      <th scope="col">Organization</th>
                      <th scope="col">Date</th>
                      <th scope="col">Hours</th>
                    </tr>
                  </thead>
                  <tbody>
                    <% @engagement_form.volunteer_shifts.ordered_by_date.each do |shift| %>
                      <tr>
                        <td><%= shift.organization_name %></td>
                        <td><%= shift.shift_date.strftime("%B %d, %Y") %></td>
                        <td><%= shift.hours %></td>
                      </tr>
                    <% end %>
                  </tbody>
                </table>
              </div>
              <p><strong>Total Hours:</strong> <%= @engagement_form.volunteer_shifts.sum(&:hours) %></p>
            <% else %>
              <p>No volunteer shifts have been added yet.</p>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
    
    <% if !@engagement_form.has_job? && !@engagement_form.is_student? && !@engagement_form.enrolled_work_program? && !@engagement_form.volunteers_nonprofit? %>
      <div class="usa-alert usa-alert--warning" role="alert">
        <div class="usa-alert__body">
          <h3 class="usa-alert__heading">No Engagement Activities Selected</h3>
          <p class="usa-alert__text">You indicated that you do not participate in any of the qualifying engagement activities. Please review the Community Engagement Requirements to ensure you meet the necessary criteria.</p>
        </div>
      </div>
    <% end %>
    
    <div class="usa-form-group">
      <% if @engagement_form.completed? %>
        <%= link_to "Download PDF", engagement_form_path(@engagement_form, format: :pdf), class: "usa-button" %>
      <% end %>
      <%= link_to "Submit Another Form", new_engagement_form_path, class: "usa-button usa-button--outline" %>
    </div>
  </div>
</div>
